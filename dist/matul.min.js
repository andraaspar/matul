!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.matul=t():e.matul=t()}(self,(function(){return function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{FragmentComp:function(){return r},HtmlResultHandler:function(){return n},Spread:function(){return i},VComponent:function(){return d},VElement:function(){return o},VPlaceholder:function(){return u},VText:function(){return a},applyHandler:function(){return B},createElement:function(){return R},getIsLogging:function(){return h},m:function(){return w},mount:function(){return _},render:function(){return N},setIsLogging:function(){return p},unmount:function(){return j}});var n={};e.r(n),e.d(n,{mount:function(){return _},render:function(){return N},unmount:function(){return j}});var r=function(e,t){return t.children},i=function(e){this.items=e},o=function(e,t,n,r){this.name=e,this.props=t,this.children=n,this.trusted=r},a=function(e){this.text=e},l=function(){function e(t){this.items=t,this.itemByKey=new Map,this.count=0;for(var n=t.length,r=0;r<t.length;r++){var i=t[r];if(i instanceof d||i instanceof o)null!=i.key&&this.itemByKey.set(i.key,i);else{if(i instanceof a||i instanceof e){this.itemByKey.clear();break}n--}}if(this.itemByKey.size&&this.itemByKey.size<n)throw new Error("[qqf32k] Duplicate / missing keys in list: actual count = "+this.itemByKey.size+" < expected count = "+n)}return e.prototype.calculateCount=function(){this.count=0;for(var t=0,n=this.items;t<n.length;t++){var r=n[t];r instanceof e||r instanceof d?this.count+=r.count:(r instanceof o||r instanceof a)&&this.count++}},e}(),u=function(e){this.value=e};function s(e){for(var t=[],n=0,r=e;n<r.length;n++){var f=r[n];if(f instanceof l||f instanceof d||f instanceof o||f instanceof a||f instanceof u)t.push(f);else if(f instanceof i)for(var c=0,v=s(f.items);c<v.length;c++){var p=v[c];t.push(p)}else Array.isArray(f)?t.push(new l(s(f))):["string","number","bigint"].includes(typeof f)?t.push(new a(f+"")):t.push(new u(f))}return t}var d=function(){function e(e,t,n){this.renderInternal=e,this.props=t,this.children=n,this.count=0,this.state={},this.internal={props:t,state:this.state,children:n}}return e.prototype.render=function(){this.renderedVirtual=this.renderInternal(void 0,this.internal),Array.isArray(this.renderedVirtual)||(this.renderedVirtual=this.renderedVirtual?[this.renderedVirtual]:[]),this.renderedVirtual=s(this.renderedVirtual),this.count=0;for(var t=0,n=this.renderedVirtual;t<n.length;t++){var r=n[t];r instanceof l||r instanceof e?this.count+=r.count:this.count++}},e}();function f(e){var t=e.handler,n=e.parent,r=e.index,i=e.virtual;if(i instanceof l)for(var u=0;u<i.items.length;u++)r=f({handler:t,parent:n,index:r,virtual:i.items[u]});else if(i instanceof d){if(r=V({handler:t,parent:n,index:r,virtuals:i.renderedVirtual,oldVirtuals:void 0,parentIsBeingRemoved:!1}),i.internal.onadded)try{i.internal.onadded()}catch(e){console.error(e)}if(i.internal.onupdated)try{i.internal.onupdated(!0)}catch(e){console.error(e)}}else if(i instanceof o){if(i.result=t.add({parent:n,index:r,virtual:i}),r++,null==i.trusted&&V({parent:i.result,handler:t,index:0,virtuals:i.children,oldVirtuals:void 0,parentIsBeingRemoved:!1}),i.ref)try{i.ref(i.result)}catch(e){console.error(e)}}else i instanceof a&&(i.result=t.add({parent:n,index:r,virtual:i}),r++);return r}function c(e){var t=e.handler,n=e.parent,r=e.index,i=e.virtual,u=e.parentIsBeingRemoved;if(i instanceof l)for(var s=0;s<i.items.length;s++)c({handler:t,parent:n,index:r,virtual:i.items[s],parentIsBeingRemoved:u});else if(i instanceof d){if(i.internal.onremove)try{i.internal.onremove()}catch(e){console.error(e)}V({handler:t,parent:n,index:r,virtuals:void 0,oldVirtuals:i.renderedVirtual,parentIsBeingRemoved:u}),i.internal.isRemoved=!0}else if(i instanceof o){if(V({handler:t,parent:i.result,index:0,virtuals:void 0,oldVirtuals:i.children,parentIsBeingRemoved:!0}),t.remove({parent:n,index:r,result:i.result,virtual:i,parentIsBeingRemoved:u}),i.ref)try{i.ref(null)}catch(e){console.error(e)}}else i instanceof a&&t.remove({parent:n,index:r,result:i.result,virtual:i,parentIsBeingRemoved:u})}var v=!0;function p(e){v=e}function h(){return v}function m(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];if(i===n)return e;i instanceof l||i instanceof d?e+=i.count:e++}throw new Error("[qyswku] Deep index not found.")}function g(e){var t=e.handler,n=e.parent,r=e.index,i=e.oldIndex,a=e.virtual;if(a instanceof l)for(var u=0;u<a.items.length;u++)r=(s=g({handler:t,parent:n,index:r,oldIndex:i+u,virtual:a.items[u]})).index,i=s.oldIndex;else if(a instanceof d)for(u=0;u<a.renderedVirtual.length;u++){var s;r=(s=g({handler:t,parent:n,index:r,oldIndex:i,virtual:a.renderedVirtual[u]})).index,i=s.oldIndex}else{if(!(a instanceof o))throw new Error("[qyt32i] Invalid move virtual type.");r!==i&&t.move({parent:n,oldIndex:i,index:r,result:a.result,virtual:a}),r<=i&&i++,r++}return{index:r,oldIndex:i}}function y(e){var t=e.handler,n=e.parent,r=e.index,i=e.virtual,u=e.oldVirtual,s=r;if(i instanceof l){var v=u;if(i.itemByKey.size&&v.itemByKey.size){for(var p=[],x=0;x<v.items.length;x++)if((b=v.items[x])instanceof d||b instanceof o){var I=i.itemByKey.get(b.key);I?(s=y({handler:t,parent:n,index:s,virtual:I,oldVirtual:b}),p.push(I)):c({handler:t,parent:n,index:s,virtual:v.items[x],parentIsBeingRemoved:!1})}for(x=0;x<i.items.length;x++){var b,B=i.items[x];B instanceof d||B instanceof o?(b=v.itemByKey.get(B.key))||(s=f({handler:t,parent:n,index:s,virtual:B}),p.push(B)):h()&&console.warn("[qysuqc] Invalid list item!",i.items,x,B)}for(var w=!0;w;)for(w=!1,x=0;x<p.length-1;x++){var R=p[x],k=p[x+1];if(i.items.indexOf(R)-i.items.indexOf(k)>0){var q=m(r,p,R);g({handler:t,parent:n,index:q,oldIndex:q+(R instanceof d?R.count:1),virtual:k}),p[x]=k,p[x+1]=R,w=!0}}}else h()&&i.items.length&&v.items.length&&console.warn("[qyt810] List without a key!",i),s=V({handler:t,parent:n,index:s,virtuals:i.items,oldVirtuals:v.items,parentIsBeingRemoved:!1})}else if(i instanceof d){if(s=V({handler:t,parent:n,index:s,virtuals:i.renderedVirtual,oldVirtuals:u.renderedVirtual,parentIsBeingRemoved:!1}),i.internal.onupdated)try{i.internal.onupdated(!1)}catch(e){console.error(e)}}else i instanceof o?(i.debug=u.debug,null!=i.debug&&--i.debug,i.result=u.result,t.update({result:i.result,virtual:i,oldVirtual:u}),s++,V({handler:t,parent:i.result,index:0,virtuals:i.children,oldVirtuals:u.children,parentIsBeingRemoved:!1})):i instanceof a&&(i.result=u.result,t.update({result:i.result,virtual:i,oldVirtual:u}),s++);return s}function x(e,t){return e instanceof l&&t instanceof l||e instanceof d&&t instanceof d&&e.renderInternal===t.renderInternal||e instanceof o&&t instanceof o&&e.name===t.name&&e.trusted===t.trusted||e instanceof a&&t instanceof a}function V(e){var t=e.handler,n=e.parent,r=e.index,i=e.virtuals,o=e.oldVirtuals,a=e.parentIsBeingRemoved;if(i)if(o){for(var l=i.length;l<o.length;l++)c({handler:t,parent:n,index:r,virtual:o[l],parentIsBeingRemoved:a});for(l=0;l<i.length;l++){var u=i[l],s=o[l];x(u,s)?r=y({handler:t,parent:n,index:r,virtual:u,oldVirtual:s}):(s&&c({handler:t,parent:n,index:r,virtual:s,parentIsBeingRemoved:!1}),r=f({handler:t,parent:n,index:r,virtual:u}))}}else for(l=0;l<i.length;l++)r=f({handler:t,parent:n,index:r,virtual:i[l]});else if(o)for(l=0;l<o.length;l++)c({handler:t,parent:n,index:r,virtual:o[l],parentIsBeingRemoved:a});return r}function I(e,t){var n,r,i,a;if(e instanceof l){var u=t;if(u&&e.itemByKey.size&&u.itemByKey.size)for(var s=0;s<e.items.length;s++){var f=e.items[s];if(f instanceof d||f instanceof o){var c=u.itemByKey.get(f.key);c&&x(f,c)?I(f,c):I(f,void 0)}}else b(e.items,null===(n=t)||void 0===n?void 0:n.items);e.calculateCount()}else if(e instanceof d){t instanceof d&&(e.debug=t.debug,null!=e.debug&&--e.debug,e.internal=t.internal,e.internal.props=e.props,e.state=e.internal.state,e.internal.children=e.children),e.render();try{b(e.renderedVirtual,null===(r=t)||void 0===r?void 0:r.renderedVirtual)}catch(n){if(!e.internal.onerror)throw n;try{e.internal.onerror(n),e.render(),b(e.renderedVirtual,null===(i=t)||void 0===i?void 0:i.renderedVirtual)}catch(e){throw console.error(e),n}}}else e instanceof o&&b(e.children,null===(a=t)||void 0===a?void 0:a.children)}function b(e,t){if(e)if(t)for(var n=0;n<e.length;n++){var r=e[n],i=t[n];x(r,i)?I(r,i):I(r,void 0)}else for(n=0;n<e.length;n++)I(e[n],void 0)}function B(e,t){var n=t?s(t):void 0,r=e.getVirtuals();n&&b(n,r),V({handler:e,parent:e.getRoot(),index:0,virtuals:n,oldVirtuals:r,parentIsBeingRemoved:!1}),e.setVirtuals(n)}function w(e,t,n){var r=Array.isArray(t)?{}:t||{},i=Array.isArray(t)?t:n||[],a=i?s(Array.isArray(i)?i:[i]):[];if("function"==typeof e){var l=r.key,u=r.debug;return delete r.key,delete r.debug,(f=new d(e,r,a)).key=l,f.debug=u,f}l=r.key;var f,c=r.ref,v=(u=r.debug,r.__UNSAFE_trust__);return delete r.key,delete r.ref,delete r.debug,delete r.__UNSAFE_trust__,(f=new o(e,r,a,v)).key=l,f.ref=c,f.debug=u,f}function R(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return w(e,t,n)}var k=/^data-/i,q=/^on/,A=function(){function e(e){this.root=e}return e.prototype.getRoot=function(){return this.root},e.prototype.getVirtuals=function(){return this.v},e.prototype.setVirtuals=function(e){this.v=e},e.prototype.add=function(e){var t,n,r=null!==(t=e.parent.ownerDocument)&&void 0!==t?t:e.parent;return e.virtual instanceof o?(z(n=r.createElement(e.virtual.name),e.virtual,void 0),null!=e.virtual.trusted&&(n.innerHTML=e.virtual.trusted)):n=r.createTextNode(e.virtual.text),e.index>=e.parent.childNodes.length?e.parent.appendChild(n):e.parent.insertBefore(n,e.parent.childNodes[e.index]),n},e.prototype.move=function(e){e.index>=e.parent.childNodes.length?e.parent.appendChild(e.result):e.parent.insertBefore(e.result,e.parent.childNodes[e.index])},e.prototype.update=function(e){if(e.virtual instanceof o){for(var t=0,n=Object.keys(e.oldVirtual.props);t<n.length;t++){var r=n[t];r in e.virtual.props||("class"===r?e.result.className="":"style"===r?e.result.removeAttribute("style"):k.test(r)?delete e.result.dataset[E(r)]:e.result[r]="")}z(e.result,e.virtual,e.oldVirtual),e.oldVirtual.trusted!==e.virtual.trusted&&(e.result.innerHTML=e.virtual.trusted)}else e.virtual.text!==e.oldVirtual.text&&(e.result.textContent=e.virtual.text);return e.result},e.prototype.remove=function(e){if(e.virtual instanceof o)for(var t=0,n=Object.keys(e.virtual.props);t<n.length;t++){var r=n[t];q.test(r)&&(e.result[r]=null)}e.parentIsBeingRemoved||e.parent.removeChild(e.result)},e}();function z(e,t,n){for(var r=0,i=Object.entries(t.props);r<i.length;r++){var o=i[r],a=o[0],l=o[1];n&&l===n.props[a]||("class"===a?e.className=null!=l?l:"":"style"===a?e.setAttribute("style",null!=l?l:""):k.test(a)?e.dataset[E(a)]=null!=l?l:"":e[a]=null!=l?l:"")}}function E(e){return e.slice(5).replace(/-([a-z])/gi,(function(e,t){return t.toUpperCase()}))}var K=[];function _(e,t){if(K.findIndex((function(t){return t[0].getRoot()===e}))>=0)throw new Error("[qzj84x] Root already mounted.");K.push([new A(e),t]),e.innerHTML=""}function j(e){var t=K.findIndex((function(t){return t[0].getRoot()===e}));if(t<0)throw new Error("[qqf154] Unknown root.");K.splice(t,1)}var C=!1,O=void 0;function N(){return O?(h()&&(console.groupCollapsed("[qz65l6] ::: Render merged."),console.trace(),console.groupEnd()),O):O=new Promise((function(e,t){requestAnimationFrame((function(){if(O=void 0,C)t(new Error("[qz65l9] Render in render not supported!"));else{C=!0,h()&&(console.groupCollapsed("[qz65lc] ►►► Render."),console.trace(),console.groupEnd());for(var n=Date.now(),r=0,i=K;r<i.length;r++){var o=i[r];B(o[0],[w(o[1],{})])}h()&&console.log("[qz65lf] ••• Rendered in "+(Date.now()-n)+" ms."),C=!1,e()}}))}))}return t}()}));